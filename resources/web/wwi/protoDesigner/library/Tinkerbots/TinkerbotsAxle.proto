#VRML_SIM R2021b utf8
# license: Copyright Cyberbotics Ltd. Licensed for use only with Webots.
# license url: https://cyberbotics.com/webots_assets_license
# Tinkerbots axle.
# https://www.tinkerbots.com
# template language: javascript

PROTO TinkerbotsAxle [
  field SFVec3f                  translation 0 0 0    # Is `Transform.translation`.
  field SFRotation               rotation    0 0 1 0  # Is `Transform.rotation`.
  field SFString                 name        "axle"   # Is `Solid.name`.
  field SFNode                   endSlot     NULL     # Slot at the opposite side of the axle. Type: "lego cross+".
  field SFString{"2.2cm", "7cm"} length      "2.2cm"  # Defines the length of the axle in centimeters.
]
{
  %<
    let l = 0.022;
    if (fields.length.value === "7cm")
      l = 0.07;

    // cross coordinates
    const a = 0.00075;
    const b = 0.00225;
  >%
  Slot {
    type "lego cross+"
    endPoint Solid {
      translation IS translation
      rotation IS rotation
      children [
        Transform {
          translation 0 0 %<= l >%
          children [
            Slot {
              type "lego cross+"
              endPoint IS endSlot
            }
          ]
        }
        Shape {
          appearance TinkerbotsPlasticAppearance {
            color "black"
          }
          geometry IndexedFaceSet {
            coord Coordinate {
              point [
                %<= a >% %<= b >% 0
                %<= a >% %<= a >% 0
                %<= b >% %<= a >% 0
                %<= b >% %<= -a >% 0
                %<= a >% %<= -a >% 0
                %<= a >% %<= -b >% 0
                %<= -a >% %<= -b >% 0
                %<= -a >% %<= -a >% 0
                %<= -b >% %<= -a >% 0
                %<= -b >% %<= a >% 0
                %<= -a >% %<= a >% 0
                %<= -a >% %<= b >% 0

                %<= a >% %<= b >% %<= l >%
                %<= a >% %<= a >% %<= l >%
                %<= b >% %<= a >% %<= l >%
                %<= b >% %<= -a >% %<= l >%
                %<= a >% %<= -a >% %<= l >%
                %<= a >% %<= -b >% %<= l >%
                %<= -a >% %<= -b >% %<= l >%
                %<= -a >% %<= -a >% %<= l >%
                %<= -b >% %<= -a >% %<= l >%
                %<= -b >% %<= a >% %<= l >%
                %<= -a >% %<= a >% %<= l >%
                %<= -a >% %<= b >% %<= l >%
              ]
            }
            coordIndex [
              0 1 2 -1 1 0 3 -1 4 5 6 -1 5 4 7 -1 8 9 10 -1 9 8 11 -1 12 13 14 -1 13 12 15 -1 16 17 18 -1 17 16 19 -1 20 21 22 -1 21 20 23 -1 0 17 6 -1 17 0 15 -1 17 4 6 -1 4 17 19 -1 4 16 7 -1 16 4 19 -1 16 5 7 -1 5 16 18 -1 5 12 3 -1 12 5 18 -1 12 1 3 -1 1 12 14 -1 20 1 14 -1 1 20 11 -1 20 9 11 -1 9 20 22 -1 21 9 22 -1 9 21 10 -1 21 8 10 -1 8 21 23 -1 13 8 23 -1 8 13 2 -1 13 0 2 -1 0 13 15 -1
            ]
            normalIndex [
              0 0 0 -1 0 0 0 -1 0 0 0 -1 0 0 0 -1 0 0 0 -1 0 0 0 -1 1 1 1 -1 1 1 1 -1 1 1 1 -1 1 1 1 -1 1 1 1 -1 1 1 1 -1 2 2 2 -1 2 2 2 -1 3 3 3 -1 3 3 3 -1 2 2 2 -1 2 2 2 -1 4 4 4 -1 4 4 4 -1 2 2 2 -1 2 2 2 -1 4 4 4 -1 4 4 4 -1 5 5 5 -1 5 5 5 -1 4 4 4 -1 4 4 4 -1 5 5 5 -1 5 5 5 -1 3 3 3 -1 3 3 3 -1 5 5 5 -1 5 5 5 -1 3 3 3 -1 3 3 3 -1
            ]
            texCoordIndex [
              0 1 1 -1 1 0 0 -1 2 0 0 -1 0 2 2 -1 1 3 3 -1 3 1 1 -1 4 5 5 -1 5 4 4 -1 6 4 4 -1 4 6 6 -1 5 7 7 -1 7 5 5 -1 0 4 0 -1 4 0 4 -1 4 2 0 -1 2 4 6 -1 2 6 2 -1 6 2 6 -1 6 0 2 -1 0 6 4 -1 0 4 0 -1 4 0 4 -1 4 1 0 -1 1 4 5 -1 5 1 5 -1 1 5 1 -1 5 3 1 -1 3 5 7 -1 7 3 7 -1 3 7 3 -1 7 1 3 -1 1 7 5 -1 5 1 5 -1 1 5 1 -1 5 0 1 -1 0 5 4 -1
            ]
            normal Normal {
              vector [
                0.0000 0.0000 -1.0000, 0.0000 0.0000 1.0000, 1.0000 0.0000 0.0000, 0.0000 1.0000 0.0000, 0.0000 -1.0000 0.0000, -1.0000 0.0000 0.0000
              ]
            }
            texCoord TextureCoordinate {
              point [
                0.0000 0.1364, 0.0000 0.0682, 0.0000 0.2045, 0.0000 0.0000, 1.0000 0.1364, 1.0000 0.0682, 1.0000 0.2045, 1.0000 0.0000
              ]
            }
            creaseAngle 0.0
          }
        }
      ]
      name IS name
      contactMaterial "tinkerbots axle"
      boundingObject Transform {
        translation 0 0 %<= 0.5 * l >%
        children [
          Box {
            size %<= 2.0 * b >% %<= 2.0 * b >% %<= l >%
          }
        ]
      }
      physics Physics {
        density -1
        mass 0.01
      }
    }
  }
}
